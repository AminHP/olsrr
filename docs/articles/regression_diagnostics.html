<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collinearity Diagnostics, Model Fit &amp; Variable Contribution • olsrr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">olsrr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rsquaredacademy/olsrr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Collinearity Diagnostics, Model Fit &amp; Variable Contribution</h1>
            
            <h4 class="date">2017-06-05</h4>
          </div>

    
    
<div class="contents">
<div id="collinearity-diagnostics" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#collinearity-diagnostics" class="anchor"> </a></body></html>Collinearity Diagnostics</h2>
<p>Collinearity implies two variables are near perfect linear combinations of one another. Multicollinearity involves more than two variables. In the presence of multicollinearity, regression estimates are unstable and have high standard errors.</p>
<div id="vif" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#vif" class="anchor"> </a></body></html>VIF</h3>
<p>Variance inflation factors measure the inflation in the variances of the parameter estimates due to collinearities that exist among the predictors. It is a measure of how much the variance of the estimated regression coefficient <span class="math inline">\(\beta_{k}\)</span> is “inflated” by the existence of correlation among the predictor variables in the model. A VIF of 1 means that there is no correlation among the kth predictor and the remaining predictor variables, and hence the variance of <span class="math inline">\(\beta_{k}\)</span> is not inflated at all. The general rule of thumb is that VIFs exceeding 4 warrant further investigation, while VIFs exceeding 10 are signs of serious multicollinearity requiring correction.</p>
<p>Steps to calculate VIF:</p>
<ul>
<li>Regress the <span class="math inline">\(k^{th}\)</span> predictor on rest of the predictors in the model.</li>
<li>Compute the <span class="math inline">\({R}^{2}_{k}\)</span>
</li>
</ul>
<p><span class="math display">\[VIF = \frac{1}{1 - {R}^{2}_{k}} = \frac{1}{Tolerance}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_coll_diag.html">ols_vif_tol</a></span>(model)</code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   Variables Tolerance   VIF
##       &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1      disp     0.125 7.985
## 2        hp     0.194 5.167
## 3        wt     0.145 6.917
## 4      qsec     0.319 3.133</code></pre>
</div>
<div id="tolerance" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#tolerance" class="anchor"> </a></body></html>Tolerance</h3>
<p>Percent of variance in the predictor that cannot be accounted for by other predictors.</p>
<p>Steps to calculate tolerance:</p>
<ul>
<li>Regress the <span class="math inline">\(k^{th}\)</span> predictor on rest of the predictors in the model.</li>
<li>Compute the <span class="math inline">\({R}^{2}_{k}\)</span>
</li>
</ul>
<p><span class="math display">\[Tolerance = 1 - {R}^{2}_{k}\]</span></p>
</div>
<div id="condition-index" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#condition-index" class="anchor"> </a></body></html>Condition Index</h3>
<p>Most multivariate statistical approaches involve decomposing a correlation matrix into linear combinations of variables. The linear combinations are chosen so that the first combination has the largest possible variance (subject to some restrictions we won’t discuss), the second combination has the next largest variance, subject to being uncorrelated with the first, the third has the largest possible variance, subject to being uncorrelated with the first and second, and so forth. The variance of each of these linear combinations is called an eigenvalue. Collinearity is spotted by finding 2 or more variables that have large proportions of variance (.50 or more) that correspond to large condition indices. A rule of thumb is to label as large those condition indices in the range of 30 or larger.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_coll_diag.html">ols_eigen_cindex</a></span>(model)</code></pre></div>
<pre><code>##   Eigenvalue Condition Index intercept disp   hp   wt qsec
## 1      4.721           1.000      0.00 0.00 0.00 0.00 0.00
## 2      0.217           4.669      0.00 0.04 0.03 0.00 0.00
## 3      0.050           9.677      0.00 0.12 0.39 0.04 0.00
## 4      0.010          21.616      0.03 0.78 0.06 0.70 0.00
## 5      0.001          57.481      0.97 0.06 0.52 0.26 0.99</code></pre>
</div>
<div id="collinearity-diagnostics-1" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#collinearity-diagnostics-1" class="anchor"> </a></body></html>Collinearity Diagnostics</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_coll_diag.html">ols_coll_diag</a></span>(model)</code></pre></div>
<pre><code>## Tolerance and Variance Inflation Factor
## ---------------------------------------
## # A tibble: 4 × 3
##   Variables Tolerance   VIF
##       &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1      disp     0.125 7.985
## 2        hp     0.194 5.167
## 3        wt     0.145 6.917
## 4      qsec     0.319 3.133
## 
## 
## Eigenvalue and Condition Index
## ------------------------------
##   Eigenvalue Condition Index intercept disp   hp   wt qsec
## 1      4.721           1.000      0.00 0.00 0.00 0.00 0.00
## 2      0.217           4.669      0.00 0.04 0.03 0.00 0.00
## 3      0.050           9.677      0.00 0.12 0.39 0.04 0.00
## 4      0.010          21.616      0.03 0.78 0.06 0.70 0.00
## 5      0.001          57.481      0.97 0.06 0.52 0.26 0.99</code></pre>
</div>
</div>
<div id="model-fit-assessment" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#model-fit-assessment" class="anchor"> </a></body></html>Model Fit Assessment</h2>
<div id="residual-fit-spread-plot" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#residual-fit-spread-plot" class="anchor"> </a></body></html>Residual Fit Spread Plot</h3>
<p>Plot to detect non-linearity, influential observations and outliers. Consists of side-by-side quantile plots of the centered fit and the residuals. It shows how much variation in the data is explained by the fit and how much remains in the residuals. For inappropriate models, the spread of the residuals in such a plot is often greater than the spread of the centered fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_rfs_plot.html">ols_rfs_plot</a></span>(model)</code></pre></div>
<p><img src="regression_diagnostics_files/figure-html/rfsplot-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="part-partial-correlations" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#part-partial-correlations" class="anchor"> </a></body></html>Part &amp; Partial Correlations</h3>
<div id="correlations" class="section level4">
<h4 class="hasAnchor">
<html><body><a href="#correlations" class="anchor"> </a></body></html>Correlations</h4>
<p>Relative importance of independent variables in determining <strong>Y</strong>. How much each variable uniquely contributes to <span class="math inline">\(R^{2}\)</span> over and above that which can be accounted for by the other predictors.</p>
<div id="zero-order" class="section level5">
<h5 class="hasAnchor">
<html><body><a href="#zero-order" class="anchor"> </a></body></html>Zero Order</h5>
<p>Pearson correlation coefficient between the dependent variable and the independent variables.</p>
</div>
<div id="part" class="section level5">
<h5 class="hasAnchor">
<html><body><a href="#part" class="anchor"> </a></body></html>Part</h5>
<p>Unique contribution of independent variables. How much <span class="math inline">\(R^{2}\)</span> will decrease if that variable is removed from the model?</p>
</div>
<div id="partial" class="section level5">
<h5 class="hasAnchor">
<html><body><a href="#partial" class="anchor"> </a></body></html>Partial</h5>
<p>How much of the variance in <strong>Y</strong>, which is not estimated by the other independent variables in the model, is estimated by the specific variable?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_correlations.html">ols_correlations</a></span>(model)</code></pre></div>
<pre><code>##                Correlations                 
## -------------------------------------------
## Variable    Zero Order    Partial     Part  
## -------------------------------------------
## disp            -0.848     -0.048    -0.019 
## hp              -0.776     -0.224    -0.093 
## wt              -0.868     -0.574    -0.285 
## qsec             0.419      0.219     0.091 
## -------------------------------------------</code></pre>
</div>
</div>
</div>
<div id="observed-vs-predicted-plot" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#observed-vs-predicted-plot" class="anchor"> </a></body></html>Observed vs Predicted Plot</h3>
<p>Plot of observed vs fitted values to assess the fit of the model. Ideally, all your points should be close to a regressed diagonal line. Draw such a diagonal line within your graph and check out where the points lie. If your model had a high R Square, all the points would be close to this diagonal line. The lower the R Square, the weaker the Goodness of fit of your model, the more foggy or dispersed your points are from this diagonal line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_ovsp_plot.html">ols_ovsp_plot</a></span>(model)</code></pre></div>
<p><img src="regression_diagnostics_files/figure-html/obspred-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="lack-of-fit-f-test" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#lack-of-fit-f-test" class="anchor"> </a></body></html>Lack of Fit F Test</h3>
<p>Assess how much of the error in prediction is due to lack of model fit. The residual sum of squares resulting from a regression can be decomposed into 2 components:</p>
<ul>
<li>Due to lack of fit</li>
<li>Due to random variation</li>
</ul>
<p>If most of the error is due to lack of fit and not just random error, the model should be discarded and a new model must be built. The lack of fit F test works only with simple linear regression. Moreover, it is important that the data contains repeat observations i.e. replicates for at least one of the values of the predictor x. This test generally only applies to datasets with plenty of replicates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_pure_error_anova.html">ols_pure_error_anova</a></span>(model)</code></pre></div>
<pre><code>## Lack of Fit F Test 
## -----------------
## Response :   mpg 
## Predictor:   disp 
## 
##                  Analysis of Variance Table                  
## ------------------------------------------------------------
##                 DF    Sum Sq    Mean Sq    F Value    Pr(&gt;F) 
## ------------------------------------------------------------
## disp             1    808.89     808.89     314.01      0.00 
## Residual        30    317.16      10.57                      
##  Lack of fit    25    304.28      12.17       4.72      0.05 
##  Pure Error      5     12.88       2.58                      
## ------------------------------------------------------------</code></pre>
</div>
<div id="diagnostics-panel" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#diagnostics-panel" class="anchor"> </a></body></html>Diagnostics Panel</h3>
<p>Panel of plots for regression diagnostics</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_diagnostic_panel.html">ols_diagnostic_panel</a></span>(model)</code></pre></div>
<p><img src="regression_diagnostics_files/figure-html/diagpanel-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="variable-contributions" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#variable-contributions" class="anchor"> </a></body></html>Variable Contributions</h2>
<div id="residual-vs-regressor-plots" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#residual-vs-regressor-plots" class="anchor"> </a></body></html>Residual vs Regressor Plots</h3>
<p>Graph to determine whether we should add a new predictor to the model already containing other predictors. The residuals from the model is regressed on the new predictor and if the plot shows non random pattern, you should consider adding the new predictor to the model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_rvsr_plot.html">ols_rvsr_plot</a></span>(model, mtcars$drat)</code></pre></div>
<p><img src="regression_diagnostics_files/figure-html/rvsrplot-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="added-variable-plot" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#added-variable-plot" class="anchor"> </a></body></html>Added Variable Plot</h3>
<p>Added variable plot provides information about the marginal importance of a predictor variable <span class="math inline">\(X_{k}\)</span>, given the other predictor variables already in the model. It shows the marginal importance of the variable in reducing the residual variability.</p>
<p>The added variable plot was introduced by Mosteller and Tukey (1977). It enables us to visualize the regression coefficient of a new variable being considered to be included in a model. The plot can be constructed for each predictor variable.</p>
<p>Let us assume we want to test the effect of adding/removing variable <em>X</em> from a model. Let the response variable of the model be <em>Y</em></p>
<p>Steps to construct an added variable plot:</p>
<ul>
<li>Regress <em>Y</em> on all variables other than <em>X</em> and store the residuals (<em>Y</em> residuals).</li>
<li>Regress <em>X</em> on all the other variables included in the model (<em>X</em> residuals).</li>
<li>Construct a scatter plot of <em>Y</em> residuals and <em>X</em> residuals.</li>
</ul>
<p>What do the <em>Y</em> and <em>X</em> residuals represent? The <em>Y</em> residuals represent the part of <strong>Y</strong> not explained by all the variables other than X. The <em>X</em> residuals represent the part of <strong>X</strong> not explained by other variables. The slope of the line fitted to the points in the added variable plot is equal to the regression coefficient when <strong>Y</strong> is regressed on all variables including <strong>X</strong>.</p>
<p>A strong linear relationship in the added variable plot indicates the increased importance of the contribution of <strong>X</strong> to the model already containing the other predictors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_avplots.html">ols_avplots</a></span>(model)</code></pre></div>
<p><img src="regression_diagnostics_files/figure-html/avplot-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="residual-plus-component-plot" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#residual-plus-component-plot" class="anchor"> </a></body></html>Residual Plus Component Plot</h3>
<p>The residual plus component plot was introduced by Ezekeil (1924). It was called as Partial Residual Plot by Larsen and McCleary (1972). Hadi and Chatterjee (2012) called it the residual plus component plot.</p>
<p>Steps to construct the plot:</p>
<ul>
<li>Regress <strong>Y</strong> on all variables including <strong>X</strong> and store the residuals (<strong>e</strong>).</li>
<li>Multiply <strong>e</strong> with regression coefficient of <strong>X</strong> (<strong>eX</strong>).</li>
<li>Construct scatter plot of <strong>eX</strong> and <strong>X</strong>
</li>
</ul>
<p>The residual plus component plot indicates whether any non-linearity is present in the relationship between <strong>Y</strong> and <strong>X</strong> and can suggest possible transformations for linearizing the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg ~<span class="st"> </span>disp +<span class="st"> </span>hp +<span class="st"> </span>wt +<span class="st"> </span>qsec, <span class="dt">data =</span> mtcars)
<span class="kw"><a href="../reference/ols_rpc_plot.html">ols_rpc_plot</a></span>(model)</code></pre></div>
<p><img src="regression_diagnostics_files/figure-html/cplusr-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#collinearity-diagnostics">Collinearity Diagnostics</a></li>
      <li><a href="#model-fit-assessment">Model Fit Assessment</a></li>
      <li><a href="#variable-contributions">Variable Contributions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Aravind Hebbali.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
